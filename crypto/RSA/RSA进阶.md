# 题解

本来想出低加密指数攻击的，结果我自己的电脑跑了一个早上没有跑出来。。。就放弃了   
提取出N，e的过程参考easy_RSA的题解。两个公钥文件提取出的N1，N2含有相同的公因数。故可以直接分解出它们各自的因数。脚本如下：  
``` python
import gmpy2
n1 = 0xA19DFAD4CB57F09CA38E12D79D972C2C49BF5CECD34822C4D9C635DAD18AAF9BB7480FF5F0FF75DC40BB60DA9B1B1042FCD5BB01E224ADAC0E70FFACABAA254675D08B202726367DACD4A944334AF672587CD7598212705096A4A4B9D5487BD6785CDF3C55FD67D49A87D578AAF431BC756545A67E671BD2986688D17B4DF8BDF57ECFBBF2A4BD501DCAAB29C3FE3F022342290BEB6087EDFCFE62EF94DBE2ED45804A8290931643010DF57F004122E9AAA1F503EFD1A82476B4A53AEF92689AD1AC7F3CC9874A018529E38B54F1B480C4F48AD1E64DC3BC0D6218953417167B94D734F926643FD706113189CF04E882C6A7E321B0150F0A0C6D0076F24A930018CF56D390F788ECB8FFED5012FE481195249465030D3A56CA52FFC0B61B36C55B3BEFE20584C9B93748940E7C1CF643F0BE350F3E962F9CAB50F566ADB7912F968FD0A5156B83E29910E35CB1E411A0CC23209CABB829F8E4E082446BE7FF0DAFFD4EF1895B61BC2B8185597F786222E100DECACB89A1AD9F155972DC404774FF1A9955AAEB8C2CD7D6675075E6D56D791AAA87FB7D6B928F659D1F12B2090F40053B89032E4AFB48FD8AD9E31C545FA92B5ECFE196CDFABDA6FE167B7A5CB32ACB78C6C44E95931C49B6F526A3E1604083658DA6C8D329274306497272817E6121E0F2C5B790480F36A3E1C9D1833A03EAD257ECA900469543CCD4A0AC0319
n2 = 0x99B225A3A72543BC37ED32CC87C331F0BDE1A391F7F6AA0DE9703EA01CA8333980014935B7807192BC1EB72A61CFDC7594658260852428EBEB4A94164445663AF6A1BF192CD916682560D785068F4E1FA05CEA0AA48B2D73381E27508B9CCC5DEC906BB30197C4F3990BA3E857D717D179C49BEE2184B3A757B1DBEB93933785F5DDCC06F05EA0D372C9AEC0C4163C58089F32999D72B2DED011D9B7157E7609C143A0B843DA282CDF4EE1EBBA90B4D0CBF68B846F88244909CE8FFC48B1837DBE77F769BC93CE5A07D16A99FDA4EC940F75895E2F3AA25B73784FCFE03C3259D7BE7E3F0F27AA7916BA415D03EFCC49A7E1CD7BAEF75943DF8F65AC9E04A4E821FB5694C184955DB62DC0CF4AC5479563AED959E7ED6158FB1BEB8817D127D42B18717C0ACD4B2A44F5720E1B89E3D3A48ED555D6193328E4DCCF1CA9CFC524DB32AB293C89AC5C9C2EF512A5BD49BD6F0A9E038E9C9823F089F2B579112AE54D9698D7E30307A2047430F9AC013CC09FF670F1A35A1DC423A7837AECC89DA3AF957A382E3E3AA95905D360FE2886B56393D6A98F2CD07E0519130AE0BD774B9419B9E5FD75D19C1F6FA839352AF17165FA3D97CC2F3CC6C3BDFB99791FEAC1A89753EF910A18EC2ED0413011E837D4A99F244A2C053FACBC3776F44D32827ED0E39F6942F65C206EE7FF1D6D42C6D1F547F9BA65320673F45A7E31B91E4CD9
p = gmpy2.gcd(n1, n2)
q1 = n1 / p
q2 = n2 / p
e = 65537

f = int(open('flag1.enc', 'rb').read().encode('hex'), 16)
n = p * q1
fn = (p - 1) * (q1 - 1)
d = gmpy2.invert(e, fn)
h = hex(gmpy2.powmod(f, d, n))[2:]
if len(h) % 2 == 1:
    h = '0' + h
s = h.decode('hex')
print s

f = int(open('flag2.enc', 'rb').read().encode('hex'), 16)
n = p * q2
fn = (p - 1) * (q2 - 1)
d = gmpy2.invert(e, fn)
h = hex(gmpy2.powmod(f, d, n))[2:]
if len(h) % 2 == 1:
    h = '0' + h
s = h.decode('hex')
print s
```

将两段明文连接起来即可得到flag.
